<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./output.css" rel="stylesheet" />
    <script src="loggedIn.js"></script>
    <title>Payment page</title>
    <script>

const queryString = window.location.search;
      const urlParams = new URLSearchParams(queryString);
      const oId = urlParams.get("id");
      console.log(oId);

        const paymentMethodFnc=(methodname)=>{
            console.log(methodname)
            fetch(`http://localhost:5023/api/Payment/MakePayment`, {
          method: "POST",
          headers: {
            Authorization: "Bearer " + localStorage.getItem("token"),
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            "oId": oId,
            "paymentMethod": methodname,
          }),
        }).then((res)=>{return res.json(); console.log(res) ;
            // window.location.href=`http://127.0.0.1:5500/cancelPayment.html?pid=${res.payId}`
            })
            .then(
                (data) => {
        console.log(data); 
        var payId =  data.payId; 
        window.location.href = `./cancelPayment.html?pid=${payId}&oid=${oId}`;
    }
)
        }
    </script>
</head>
<body onload="tokenValidation();">
    <div class="flex justify-center items-center w-full h-screen">
        <div class="w-[40%] flex flex-col h-[50%] justify-center items-center border border-pink-500 rounded-md gap-y-4">
            <button class="self-center w-[48%] py-1 px-2 bg-pink-500 rounded-md hover:bg-pink-600 text-white" value="cod" onclick="paymentMethodFnc('cod')">Cash on Delivery</button>
            <div class="flex justify-between items-center w-full">
                <div class="border border-pink-500 w-[30%] h-0 ml-12"></div><div>or</div><div class="border border-pink-500 w-[30%] h-0 mr-12"></div>
            </div>
            <button class="self-center w-[48%] py-1 px-2 bg-pink-500 rounded-md hover:bg-pink-600 text-white" value="online" onclick="paymentMethodFnc('online')">Pay online now</button>
        </div>
    </div>
    
</body>
</html>