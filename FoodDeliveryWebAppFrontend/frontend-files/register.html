<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./output.css" rel="stylesheet">
    <script src="loggedIn.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <title>Register Page</title>
    <script>
        const clickButton = () => {
        const txtRole = document.getElementById('txtRole').value;
        const txtPhone = document.getElementById('txtPhone').value;
        const txtName = document.getElementById('txtName').value;
        const txtPassword = document.getElementById('txtPass').value;
        
        if(txtRole=="Admin")
        {fetch(`http://localhost:5023/api/User/RegisterAdmin` , {
          method: "POST",
          headers: { 
            "Authorization": "Bearer " + localStorage.getItem("token"),
            "Content-Type" : "application/json"
           },
          body: JSON.stringify({
           
                "role":txtRole,
                "phone":txtPhone,
                "name":txtName,
                "aPassword":txtPassword
          
          }),
        })
          .then((res) => {
            if (!res.ok) {
                throw new Error('Network response was not ok');
            }
            res.json(); window.location.href="./login.html";showToast("Successfully registered Admin",1000,'#00b300')})
          .catch(error => {
        showToast('Error registering Admin',1000,'#de0a26');
        console.error('Error fetching data:', error);})
        }

          else if(txtRole=="Customer")
        {fetch(`http://localhost:5023/api/User/RegisterCustomer` , {
          method: "POST",
          headers: { 
            "Authorization": "Bearer " + localStorage.getItem("token"),
            "Content-Type" : "application/json"
           },
          body: JSON.stringify({
           
                "role":txtRole,
                "phone":txtPhone,
                "name":txtName,
                "cPassword":txtPassword
          
          }),
        })
          .then((res) => {
            if (!res.ok) {
                throw new Error('Network response was not ok');
            }
            res.json(); window.location.href="./login.html"; showToast("Successfully registered Customer",1000,'#00b300')})
          .catch(error => {
        showToast('Error registering Customer',1000,'#de0a26');
        console.error('Error fetching data:', error);})
        }
      };

    </script>
</head>
<body onload="checkLoggedIn()">
    <div class="w-full h-screen flex flex-col " id="main-div">
        <div class="flex justify-between items-center h-[11%] border-b-4 border-pink-500">
            <div class="px-4 text-pink-500 text-4xl">
                ELFY'S CAFETERIA
            </div>
        </div>
        <div class=" h-auto my-10 self-center flex flex-col p-8 gap-y-4 items-center border border-pink-500 shadow-md rounded-md md:w-[40%] sm:w-[60%] w-[70%]">
            <div class="px-4 text-pink-500 text-2xl ">
                Register
            </div>
            <div class="flex flex-col justify-center items-center gap-y-4 w-[80%]">
                <input type="text" id="txtName" placeholder="Enter Name" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-pink-600 shadow-md" >
                <input type="text" placeholder="Enter Address" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-pink-600 shadow-md" >
                <input type="text" id="txtPhone" placeholder="Enter Phone" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-pink-600 shadow-md" >
                <input type="password" id="txtPass" placeholder="Enter Password" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-pink-600 shadow-md" >
                <input type="password" id="txtCPass" placeholder="Enter Confirm Password" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-pink-600 shadow-md" >
                <select name="role" id="txtRole" class="w-full text-pink-500 placeholder-pink-800/50 placeholder:text-xs rounded-md px-3 py-1 border border-pink-500 focus:outline-none shadow-md">
                    <option value="none" selected disabled hidden>Select an Option</option>
                    <option value="Admin">Admin</option>
                    <option value="Customer">Customer</option>
                </select>
            </div>
            <button onclick="clickButton()" class="self-center w-[48%] py-1 mt-4 bg-pink-500 rounded-full hover:bg-pink-600 text-white">
                Register 
            </button>
        </div>
    </div>
</body>
</html>